!function(){"use strict";angular.module("shico",["ngResource","ngAnimate","ui.bootstrap","toastr","nvd3","rzModule","cgBusy","ngSanitize","ngCsv","hc.marked"])}(),function(){"use strict";function e(e,r){function a(){return s.parameters}function t(e){angular.forEach(s.parameters,function(r,a){angular.isDefined(e[a])&&(s.parameters[a]=e[a])})}function o(){var e=s.availableYears.values,r=s.availableYears.from,a=s.availableYears.to;s.parameters.startKey=e[r],s.parameters.endKey=e[a]}function n(a,t){e({method:"GET",url:a}).success(function(e){s.tooltips[t]=r(e)})}var s=this;s.parameters={terms:"",maxTerms:10,maxRelatedTerms:10,startKey:"",endKey:"",minDist:.7,wordBoost:1,forwards:"Forward",boostMethod:"Sum similarity",algorithm:"Adaptive",aggWeighFunction:"Gaussian",aggWFParam:1,aggYearsInInterval:5,aggWordsPerYear:5,doCleaning:"No"},s.availableYears={from:0,to:1,values:{},options:{floor:0,ceil:1,step:1,onChange:o}},s.features={canClean:!1},s.tooltips={},n("/help/algorithm.md","algorithm");var i={getParameters:a,setParameters:t,tooltips:s.tooltips,availableYears:s.availableYears,features:s.features};return i}angular.module("shico").service("TrackerParametersService",e),e.$inject=["$http","marked"]}(),function(){"use strict";function e(){var e={scope:{},templateUrl:"app/components/shico/trackerParameters.template.html",controllerAs:"vm",controller:"TrackerParametersController"};return e}angular.module("shico").directive("trackerParameters",e)}(),function(){"use strict";function e(e){var r=this;r.algorithms=["Adaptive","Non-adaptive"],r.weighFuncs=["Gaussian","Linear","JSD"],r.directions=["Forward","Backward"],r.boostMethods=["Sum similarity","Counts"],r.doCleaning=["Yes","No"],r.years=e.availableYears,r.features=e.features,r.parameters=e.getParameters(),r.tooltips=e.tooltips}angular.module("shico").controller("TrackerParametersController",e),e.$inject=["TrackerParametersService"]}(),function(){"use strict";function e(){var e={scope:{},templateUrl:"app/components/shico/trackerGraphs.template.html",controllerAs:"vm",controller:"TrackerGraphsController"};return e}angular.module("shico").directive("trackerGraphs",e)}(),function(){"use strict";function e(e){function r(e){return o.forceGraph.currYearIdx-1<=e&&e<=o.forceGraph.currYearIdx+1}function a(e){e.svg.attr("style","border-style: solid")}function t(){var r=e.getRawData().stream,a=new Set,t=[];angular.forEach(r,function(e,r){t.push(r),angular.forEach(e,function(e,r){a.add(r)})});var o=[""].concat(t),n=[o];return angular.forEach(a,function(e){var a=[e];angular.forEach(t,function(t){var o=e in r[t]?r[t][e]:0;a.push(o)}),n.push(a)}),n}var o=this;o.streamGraph=e.streamGraph,o.forceGraph=e.forceGraph,o.slider_options=e.slider_options,o.getYearLabel=e.getYearLabel,o.yearsInSight=r,o.addBorder=a,o.downloadData=t}angular.module("shico").controller("TrackerGraphsController",e),e.$inject=["GraphControlService"]}(),function(){"use strict"}(),function(){"use strict";function e(){var e={scope:{},templateUrl:"app/components/shico/parameterIO.template.html",controllerAs:"vm",controller:"ParameterIOController"};return e}angular.module("shico").directive("parameterIo",e)}(),function(){"use strict";function e(e){function r(){o.hide=!1,o.readOnly=!0,o.text=JSON.stringify(e.getParameters()),o.btnText="Ok"}function a(){o.hide=!1,o.readOnly=!1,o.text="",o.btnText="Load"}function t(){if(o.hide=!0,!o.readOnly){var r=JSON.parse(o.text);e.setParameters(r)}}var o=this;o.getParameters=r,o.setParameters=a,o.closeParamIO=t,o.text="",o.readOnly=!1,o.hide=!0}angular.module("shico").controller("ParameterIOController",e),e.$inject=["TrackerParametersService"]}(),function(){"use strict";function e(e){function r(e){return s.yearLabels[e]}function a(r){s.rawData=r;var a=[],t=new Set;angular.forEach(r.stream,function(e,r){a.push(r),angular.forEach(e,function(e,r){t.add(r)})});var i={};angular.forEach(a,function(e,r){i[e]=r}),e.setVocabulary(t),e.setStreamYears(a),s.yearLabels=a;var l=o(r.stream,i,t,a),c=n(r.networks,i);s.streamGraph.data=l,s.forceGraph.data=c,s.slider_options.ceil=s.yearLabels.length-1}function t(){return s.rawData}function o(e,r,a,t){var o=[];return angular.forEach(a,function(a){var o=[];angular.forEach(t,function(t){var o=a in e[t]?e[t][a]:0;this.push([r[t],o])},o),this.push({key:a,values:o})},o),o}function n(e,r){var a={};return angular.forEach(e,function(e,t){a[r[t]]=e}),a}var s=this;s.streamGraph={options:e.getConfig("streamGraph"),data:[]},s.forceGraph={options:e.getConfig("forceGraph"),data:[],currYearIdx:0},s.yearLabels=[],s.slider_options={floor:0,ceil:0,showTicksValues:!1,translate:r};var i={update:a,getRawData:t,getYearLabel:r,streamGraph:s.streamGraph,forceGraph:s.forceGraph,slider_options:s.slider_options};return i}angular.module("shico").service("GraphControlService",e),e.$inject=["GraphConfigService"]}(),function(){"use strict";function e(){function e(e){var r=0;angular.forEach(e,function(e){k[e]=r,r+=1})}function r(e){var r=e.key||e.name,a=k[r];return a?b(a):"#223344"}function a(e){return e[0]}function t(e){return e[1]}function o(e){return parseFloat(e).toFixed(1)}function n(e){return e in y?y[e]:e}function s(e){y=e}function i(e){l(e),c(e),angular.forEach(x,function(r){r(e)})}function l(e){e.append("text").attr("dx",12).attr("dy",".35em").text(function(e){return e.name}).style("font-weight",function(e){return"seed"==e.type?"bold":""})}function c(e){e.select("circle").attr("r",function(e){return 5+2*e.count})}function m(e){return"seed"==e.type?"triangle-up":"word"==e.type?"circle":"diamond"}function u(e){return 50*Math.log2(2+e.count)}function d(e){var r=["type","count","weight"],a="<table>";return a+='<thead><tr><td colspan="2"><strong class="x-value">'+e.name+"</strong></td></tr></thead>",a+="<tbody>",angular.forEach(r,function(r){a+="<tr>",a+='<td class="key">'+r+"</td>",a+='<td class="value">'+e[r]+"</td>",a+="</tr>"}),a+="</tbody>",a+="</table>"}function p(e){x.push(e)}function v(e){return"streamGraph"===e?f:"forceGraph"===e?h:void 0}var f={chart:{type:"stackedAreaChart",height:500,margin:{top:20,right:20,bottom:60,left:55},x:a,y:t,xAxis:{tickFormat:n},yAxis:{tickFormat:o},color:r}},g=d3.svg.symbol().type(m).size(u),h={chart:{type:"forceDirectedGraph",height:300,width:300,color:r,symbol:g,nodeExtras:i,curveLinks:!0,useArrows:!0,tooltip:{contentGenerator:d}}},b=d3.scale.category20(),y={},x=[],k={},w={getConfig:v,setStreamYears:s,addForceGraphHook:p,setVocabulary:e};return w}angular.module("shico").service("GraphConfigService",e)}(),function(){"use strict";function e(e,r,a){function t(){var t=r.getParameters(),n=e.trackConcept(t);o.trackerPromise=n,n.then(a.update)}var o=this;o.doPost=t}angular.module("shico").controller("FormController",e),e.$inject=["ConceptService","TrackerParametersService","GraphControlService"]}(),function(){"use strict";function e(e,r){function a(){var a=e("config.json");a.get().$promise.then(function(a){var o=a.baseURL,n=o+"/track/:terms",s=o+"/load-settings";0==o.length&&(n="dummy2.json",s="http://localhost:5000/load-settings"),t.trackerURL=n;var i=e(s);i.get().$promise.then(function(e){r.availableYears.from=e.years.first,r.availableYears.to=e.years.last,r.availableYears.values=e.years.values,r.availableYears.options.floor=e.years.first,r.availableYears.options.ceil=e.years.last,r.features.canClean=e.cleaning})})}var t={doLoad:a};return t}angular.module("shico").service("SettingsService",e),e.$inject=["$resource","TrackerParametersService"]}(),function(){"use strict";function e(e,r,a){function t(r){var t=e(a.trackerURL),n=t.get(r),s=n.$promise.then(o);return s}function o(e){return angular.forEach(e.networks,function(e,r){angular.forEach(e.nodes,function(e){e.year=r})}),e.toJSON()}var n={trackConcept:t};return n}angular.module("shico").service("ConceptService",e),e.$inject=["$resource","$log","SettingsService"]}(),function(){"use strict";function e(e,r){e.debug("runBlock end"),r.doLoad()}angular.module("shico").run(e),e.$inject=["$log","SettingsService"]}(),function(){"use strict";angular.module("shico")}(),function(){"use strict";function e(e,r){e.debugEnabled(!0),r.allowHtml=!0,r.timeOut=3e3,r.positionClass="toast-top-right",r.preventDuplicates=!0,r.progressBar=!0}angular.module("shico").config(e),e.$inject=["$logProvider","toastrConfig"]}(),angular.module("shico").run(["$templateCache",function(e){e.put("app/components/shico/parameterIO.template.html",'<div class="row"><div class="col-md-2"><button ng-click="vm.getParameters()" class="btn btn-success">Save parameters</button></div><div class="col-md-2"><button ng-click="vm.setParameters()" class="btn btn-success">Load parameters</button></div></div><br><div class="row" ng-hide="vm.hide"><div class="col-md-8"><textarea class="form-control" rows="2" ng-readonly="vm.readOnly" ng-model="vm.text"></textarea></div><div class="col-md-2"><button ng-click="vm.closeParamIO()" class="btn btn-success">{{ vm.btnText }}</button></div></div>'),e.put("app/components/shico/trackerGraphs.template.html",'<div class="row" ng-if="vm.forceGraph.data.length != 0"><div class="row col-md-12"><nvd3 data="vm.streamGraph.data" options="vm.streamGraph.options"></nvd3></div><div class="row col-md-12"><div class="col-md-4" ng-repeat="(yearIdx,yearData) in vm.forceGraph.data" ng-if="vm.yearsInSight(yearIdx)"><span class="label label-default">{{ vm.getYearLabel(yearIdx) }}</span><nvd3 data="yearData" options="vm.forceGraph.options" on-ready="vm.addBorder"></nvd3></div><rzslider ng-hide="!vm.slider_options.ceil" rz-slider-model="vm.forceGraph.currYearIdx" rz-slider-options="vm.slider_options"></rzslider></div><div class="row col-md-12 pager"><button class="btn btn-success" ng-csv="vm.downloadData()" filename="test.csv">Save data</button></div></div>'),e.put("app/components/shico/trackerParameters.template.html",'<div class="row form-horizontal col-md-12"><p class="lead">Concept search</p><div class="form-group col-md-11"><input type="text" ng-model="vm.parameters.terms" class="form-control" id="terms" placeholder="Search concepts"></div><div class="form-group col-md-1"><button type="button" class="btn btn-primary" ng-click="isOpen = !isOpen">+</button></div><div uib-collapse="!isOpen"><div><div class="form-group form-inline col-md-4"><label for="maxConcepts">Max terms</label> <input type="number" ng-model="vm.parameters.maxTerms" min="1" max="20" class="form-control" id="maxConcepts"></div><div class="form-group form-inline col-md-4"><label for="maxRelatedTerms">Max related terms</label> <input type="number" ng-model="vm.parameters.maxRelatedTerms" min="1" max="20" class="form-control" id="maxRelatedTerms"></div><div class="form-group form-inline col-md-4"><label for="minDist">Minimum concept distance</label> <input type="number" ng-model="vm.parameters.minDist" min="0.1" max="10.0" step="0.1" class="form-control" id="minDist"></div><div class="form-group form-inline col-md-4"><label for="wordBoost">Word boost</label> <input type="number" ng-model="vm.parameters.wordBoost" min="0.1" max="10.0" step="0.1" class="form-control" id="wordBoost"></div><div class="form-group form-inline col-md-4"><label for="sumDistances">Boost method</label><select ng-model="vm.parameters.boostMethod" name="boostMethod"><option data-ng-repeat="method in vm.boostMethods" value="{{ method }}">{{ method }}</option></select></div><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'algorithm\']" popover-trigger="click" popover-placement="bottom" for="algorithm">Algorithm:</label><select ng-model="vm.parameters.algorithm" name="algorithm"><option data-ng-repeat="algo in vm.algorithms" value="{{ algo }}">{{ algo }}</option></select></div><div class="form-group col-md-12"><label for="forward">Track direction</label><select ng-model="vm.parameters.forwards" name="forward"><option data-ng-repeat="dir in vm.directions" value="{{ dir }}">{{ dir }}</option></select></div><div class="form-group form-inline col-md-4"><label for="yearsInterval">Years in interval</label> <input type="number" ng-model="vm.parameters.aggYearsInInterval" min="1" max="10" step="1" class="form-control" id="yearsInterval"></div><div class="form-group form-inline col-md-4"><label for="wordsPerYear">Words per year</label> <input type="number" ng-model="vm.parameters.aggWordsPerYear" min="1" max="100" step="1" class="form-control" id="wordsPerYear"></div><div class="form-group form-inline col-md-4"><label for="aggWeighFunc">Weighing function</label><select ng-model="vm.parameters.aggWeighFunction" name="aggWeighFunc"><option data-ng-repeat="wFunc in vm.weighFuncs" value="{{ wFunc }}">{{ wFunc }}</option></select></div><div class="form-group form-inline col-md-4"><label for="aggWFParam">Weighing function parameter</label> <input type="number" ng-model="vm.parameters.aggWFParam" min="1" max="10" step="0.1" class="form-control" id="aggWFParam"></div><div class="form-group form-inline col-md-4" ng-if="vm.features.canClean"><label for="doCleaning">Do cleaning ?</label><select ng-model="vm.parameters.doCleaning" name="doCleaning"><option data-ng-repeat="opt in vm.doCleaning" value="{{ opt }}">{{ opt }}</option></select></div></div><div class="form-group col-md-11">Year period:<rzslider rz-slider-model="vm.years.from" rz-slider-high="vm.years.to" rz-slider-options="vm.years.options"></rzslider></div></div></div>')}]);
//# sourceMappingURL=../maps/scripts/app.js.map
