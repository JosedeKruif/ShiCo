!function(){"use strict";angular.module("shico",["ngResource","ngAnimate","ui.bootstrap","toastr","nvd3","rzModule","cgBusy","ngSanitize","ngCsv","hc.marked"])}(),function(){"use strict";function e(e,r){function t(){return i.parameters}function a(e){angular.forEach(i.parameters,function(r,t){angular.isDefined(e[t])&&(i.parameters[t]=e[t])})}function o(){var e=i.availableYears.values,r=i.availableYears.from,t=i.availableYears.to;i.parameters.startKey=e[r],i.parameters.endKey=e[t]}function n(t,a){e({method:"GET",url:t}).success(function(e){i.tooltips[a]=r(e)})}var i=this;i.parameters={terms:"",maxTerms:10,maxRelatedTerms:10,startKey:"",endKey:"",minSim:.5,wordBoost:1,forwards:"Forward",boostMethod:"Sum similarity",algorithm:"Adaptive",aggWeighFunction:"Gaussian",aggWFParam:1,aggYearsInInterval:2,aggWordsPerYear:5,doCleaning:"No"},i.availableYears={from:0,to:1,values:{},options:{floor:0,ceil:1,step:1,onChange:o}},i.features={canClean:!1},i.tooltips={},n("/help/seedConcept.md","seedConcept"),n("/help/maxTerms.md","maxTerms"),n("/help/maxRelatedTerms.md","maxRelatedTerms"),n("/help/minSim.md","minSim"),n("/help/wordBoost.md","wordBoost"),n("/help/boostMethod.md","boostMethod"),n("/help/algorithm.md","algorithm"),n("/help/direction.md","direction"),n("/help/yearsInInterval.md","yearsInInterval"),n("/help/wordsPerYear.md","wordsPerYear"),n("/help/weighFunc.md","weighFunc"),n("/help/wFParam.md","wFParam"),n("/help/doCleaning.md","doCleaning"),n("/help/yearPeriod.md","yearPeriod");var s={getParameters:t,setParameters:a,tooltips:i.tooltips,availableYears:i.availableYears,features:i.features};return s}angular.module("shico").service("TrackerParametersService",e),e.$inject=["$http","marked"]}(),function(){"use strict";function e(){var e={scope:{},templateUrl:"app/components/shico/trackerParameters.template.html",controllerAs:"vm",controller:"TrackerParametersController"};return e}angular.module("shico").directive("trackerParameters",e)}(),function(){"use strict";function e(e,r,t){function a(){o.isOpen=!o.isOpen,r(function(){e.$broadcast("rzSliderForceRender")},500)}var o=this;o.algorithms=["Adaptive","Non-adaptive"],o.weighFuncs=["Gaussian","Linear","JSD"],o.directions=["Forward","Backward"],o.boostMethods=["Sum similarity","Counts"],o.doCleaning=["Yes","No"],o.isOpen=!1,o.years=t.availableYears,o.features=t.features,o.parameters=t.getParameters(),o.tooltips=t.tooltips,o.toggleOpen=a}angular.module("shico").controller("TrackerParametersController",e),e.$inject=["$scope","$timeout","TrackerParametersService"]}(),function(){"use strict";function e(){var e={scope:{},templateUrl:"app/components/shico/trackerGraphs.template.html",controllerAs:"vm",controller:"TrackerGraphsController"};return e}angular.module("shico").directive("trackerGraphs",e)}(),function(){"use strict";function e(e){function r(e){return o.forceGraph.currYearIdx-1<=e&&e<=o.forceGraph.currYearIdx+1}function t(e){e.svg.attr("style","border-style: solid")}function a(){var r=e.getRawData().stream,t=new Set,a=[];angular.forEach(r,function(e,r){a.push(r),angular.forEach(e,function(e,r){t.add(r)})});var o=[""].concat(a),n=[o];return angular.forEach(t,function(e){var t=[e];angular.forEach(a,function(a){var o=e in r[a]?r[a][e]:0;t.push(o)}),n.push(t)}),n}var o=this;o.streamGraph=e.streamGraph,o.forceGraph=e.forceGraph,o.scatterGraph=e.scatterGraph,o.vocabularies=e.vocabularies,o.slider_options=e.slider_options,o.getYearLabel=e.getYearLabel,o.yearsInSight=r,o.addBorder=t,o.downloadData=a}angular.module("shico").controller("TrackerGraphsController",e),e.$inject=["GraphControlService"]}(),function(){"use strict"}(),function(){"use strict";function e(){var e={scope:{},templateUrl:"app/components/shico/parameterIO.template.html",controllerAs:"vm",controller:"ParameterIOController"};return e}angular.module("shico").directive("parameterIo",e)}(),function(){"use strict";function e(e){function r(){o.hide=!1,o.readOnly=!0,o.text=JSON.stringify(e.getParameters()),o.btnText="Ok"}function t(){o.hide=!1,o.readOnly=!1,o.text="",o.btnText="Load"}function a(){if(o.hide=!0,!o.readOnly){var r=JSON.parse(o.text);e.setParameters(r)}}var o=this;o.getParameters=r,o.setParameters=t,o.closeParamIO=a,o.text="",o.readOnly=!1,o.hide=!0}angular.module("shico").controller("ParameterIOController",e),e.$inject=["TrackerParametersService"]}(),function(){"use strict";function e(e){function r(e){return s.yearLabels[e]}function t(r){s.rawData=r;var t=[],a=new Set;angular.forEach(r.stream,function(e,r){t.push(r),angular.forEach(e,function(e,r){a.add(r)})});var l={};angular.forEach(t,function(e,r){l[e]=r}),e.setVocabulary(a),e.setStreamYears(t),s.yearLabels=t;var c=o(r.stream,l,a,t),m=n(r.networks,l),d=i(r.embedded,l);s.streamGraph.data=c,s.forceGraph.data=m,s.scatterGraph.data=d,s.vocabularies.data=r.vocabs,s.slider_options.ceil=s.yearLabels.length-1}function a(){return s.rawData}function o(e,r,t,a){var o=[];return angular.forEach(t,function(t){var o=[];angular.forEach(a,function(a){var o=t in e[a]?e[a][t]:0;this.push([r[a],o])},o),this.push({key:t,values:o})},o),o}function n(e,r){var t={};return angular.forEach(e,function(e,a){t[r[a]]=e}),t}function i(e,r){var t={};return angular.forEach(e,function(e,a){var o=[{key:"Group0",values:e}];t[r[a]]=o}),t}var s=this;s.streamGraph={options:e.getConfig("streamGraph"),data:[]},s.forceGraph={options:e.getConfig("forceGraph"),data:[],currYearIdx:0},s.scatterGraph={options:e.getConfig("scatterGraph"),data:[]},s.vocabularies={data:[]},s.yearLabels=[],s.slider_options={floor:0,ceil:0,showTicksValues:!1,translate:r};var l={update:t,getRawData:a,getYearLabel:r,streamGraph:s.streamGraph,forceGraph:s.forceGraph,scatterGraph:s.scatterGraph,vocabularies:s.vocabularies,slider_options:s.slider_options};return l}angular.module("shico").service("GraphControlService",e),e.$inject=["GraphConfigService"]}(),function(){"use strict";function e(){function e(e){d3.selectAll(".label").remove(),d3.selectAll(".nv-scatterChart path")[0].forEach(function(e){var r=d3.select(e).attr("transform"),t=d3.transform(r).translate;t[0]=t[0]+10;var a=d3.select(e).data();if(a[0][0]){var o=a[0][0].word;d3.select(e.parentNode).append("text").attr("class","label").text(o).attr("transform","translate("+t[0]+","+t[1]+")")}})}function r(e){var r=0;angular.forEach(e,function(e){G[e]=r,r+=1})}function t(e){var r=e.key||e.name,t=G[r];return t?w(t):"#223344"}function a(e){return e[0]}function o(e){return e[1]}function n(e){return parseFloat(e).toFixed(1)}function i(e){return e in x?x[e]:e}function s(e){x=e}function l(e){c(e),m(e),angular.forEach(k,function(r){r(e)})}function c(e){e.append("text").attr("dx",12).attr("dy",".35em").text(function(e){return e.name}).style("font-weight",function(e){return"seed"==e.type?"bold":""})}function m(e){e.select("circle").attr("r",function(e){return 5+2*e.count})}function d(e){return"seed"==e.type?"triangle-up":"word"==e.type?"circle":"diamond"}function p(e){return 50*Math.log2(2+e.count)}function u(e){var r=["type","count","weight"],t="<table>";return t+='<thead><tr><td colspan="2"><strong class="x-value">'+e.name+"</strong></td></tr></thead>",t+="<tbody>",angular.forEach(r,function(r){t+="<tr>",t+='<td class="key">'+r+"</td>",t+='<td class="value">'+e[r]+"</td>",t+="</tr>"}),t+="</tbody>",t+="</table>"}function v(e){k.push(e)}function g(e){return"streamGraph"===e?h:"forceGraph"===e?b:"scatterGraph"===e?y:void 0}var h={chart:{type:"stackedAreaChart",height:500,width:1e3,margin:{top:20,right:20,bottom:60,left:55},x:a,y:o,xAxis:{tickFormat:i},yAxis:{tickFormat:n},color:t}},f=d3.svg.symbol().type(d).size(p),b={chart:{type:"forceDirectedGraph",height:300,width:300,color:t,symbol:f,nodeExtras:l,curveLinks:!0,useArrows:!0,tooltip:{contentGenerator:u}}},y={chart:{type:"scatterChart",height:500,width:1e3,color:["#1f77b4"],duration:350,zoom:{enabled:!0,scaleExtent:[1,10],useFixedDomain:!1,useNiceScale:!1,horizontalOff:!1,verticalOff:!1,unzoomEventType:"dblclick.zoom"},tooltip:{enabled:!1},showLabels:!1,xAxis:{showMaxMin:!1,tickFormat:function(){return""}},yAxis:{showMaxMin:!1,tickFormat:function(){return""}},dispatch:{renderEnd:e}}},w=d3.scale.category20(),x={},k=[],G={},C={getConfig:g,setStreamYears:s,addForceGraphHook:v,setVocabulary:r};return C}angular.module("shico").service("GraphConfigService",e)}(),function(){"use strict";function e(e,r,t){function a(){var a=r.getParameters(),n=e.trackConcept(a);o.trackerPromise=n,n.then(t.update)}var o=this;o.doPost=a}angular.module("shico").controller("FormController",e),e.$inject=["ConceptService","TrackerParametersService","GraphControlService"]}(),function(){"use strict";function e(e,r){function t(){var t=e("config.json");t.get().$promise.then(function(t){var o=t.baseURL,n=o+"/track/:terms",i=o+"/load-settings";0==o.length&&(n="dummy2.json",i="http://localhost:5000/load-settings"),a.trackerURL=n;var s=e(i);s.get().$promise.then(function(e){r.availableYears.from=e.years.first,r.availableYears.to=e.years.last,r.availableYears.values=e.years.values,r.availableYears.options.floor=e.years.first,r.availableYears.options.ceil=e.years.last,r.features.canClean=e.cleaning})})}var a={doLoad:t};return a}angular.module("shico").service("SettingsService",e),e.$inject=["$resource","TrackerParametersService"]}(),function(){"use strict";function e(e,r,t){function a(r){var a=e(t.trackerURL),n=a.get(r),i=n.$promise.then(o);return i}function o(e){return angular.forEach(e.networks,function(e,r){angular.forEach(e.nodes,function(e){e.year=r})}),e.toJSON()}var n={trackConcept:a};return n}angular.module("shico").service("ConceptService",e),e.$inject=["$resource","$log","SettingsService"]}(),function(){"use strict";function e(e,r){e.debug("runBlock end"),r.doLoad()}angular.module("shico").run(e),e.$inject=["$log","SettingsService"]}(),function(){"use strict";angular.module("shico")}(),function(){"use strict";function e(e,r){e.debugEnabled(!0),r.allowHtml=!0,r.timeOut=3e3,r.positionClass="toast-top-right",r.preventDuplicates=!0,r.progressBar=!0}angular.module("shico").config(e),e.$inject=["$logProvider","toastrConfig"]}(),angular.module("shico").run(["$templateCache",function(e){e.put("app/components/shico/parameterIO.template.html",'<div class="row"><div class="col-md-2"><button ng-click="vm.getParameters()" class="btn btn-success">Save parameters</button></div><div class="col-md-2"><button ng-click="vm.setParameters()" class="btn btn-success">Load parameters</button></div></div><br><div class="row" ng-hide="vm.hide"><div class="col-md-8"><textarea class="form-control" rows="2" ng-readonly="vm.readOnly" ng-model="vm.text"></textarea></div><div class="col-md-2"><button ng-click="vm.closeParamIO()" class="btn btn-success">{{ vm.btnText }}</button></div></div>'),e.put("app/components/shico/trackerGraphs.template.html",'<div class="row" ng-if="vm.forceGraph.data.length != 0"><uib-tabset active="active"><uib-tab index="0" heading="Stream graph"><div class="row col-md-12"><nvd3 data="vm.streamGraph.data" options="vm.streamGraph.options"></nvd3></div></uib-tab><uib-tab index="1" heading="Network graphs"><div class="row col-md-12"><div class="col-md-4" ng-repeat="(yearIdx,yearData) in vm.forceGraph.data" ng-if="vm.yearsInSight(yearIdx)"><span class="badge">{{ vm.getYearLabel(yearIdx) }}</span><nvd3 data="yearData" options="vm.forceGraph.options" on-ready="vm.addBorder"></nvd3></div><rzslider ng-hide="!vm.slider_options.ceil" rz-slider-model="vm.forceGraph.currYearIdx" rz-slider-options="vm.slider_options"></rzslider></div></uib-tab><uib-tab index="2" heading="Space embedding"><div class="row col-md-12"><nvd3 data="vm.scatterGraph.data[vm.forceGraph.currYearIdx]" options="vm.scatterGraph.options"></nvd3><rzslider ng-hide="!vm.slider_options.ceil" rz-slider-model="vm.forceGraph.currYearIdx" rz-slider-options="vm.slider_options"></rzslider></div></uib-tab><uib-tab index="3" heading="Plain text vocabulary"><div class="row col-md-12"><div class="row"><div class="col-md-2"><h4>Model for years</h4></div><div class="col-md-10"><div class="col-md-2"><h4>Seed word</h4></div><div class="col-md-8"><h4>Vocabulary</h4></div></div></div><div class="row" ng-repeat="(year, yLinks) in vm.vocabularies.data"><hr><div class="col-md-2"><strong>{{ year }}</strong></div><div class="col-md-10"><div ng-repeat="(seed, terms) in yLinks"><div class="col-md-4"><strong>{{ seed }}</strong></div><div class="col-md-8"><span ng-repeat="term in terms">{{ term[0] }} &nbsp;</span>&nbsp;</div></div></div></div></div></uib-tab></uib-tabset><div class="row col-md-12 pager"><button class="btn btn-success" ng-csv="vm.downloadData()" filename="test.csv">Save data</button></div></div>'),e.put("app/components/shico/trackerParameters.template.html",'<div class="row form-horizontal col-md-12"><p class="lead" uib-popover-html="vm.tooltips[\'seedConcept\']" popover-trigger="click" popover-placement="bottom">Concept search</p><div class="form-group col-md-11"><input type="text" ng-model="vm.parameters.terms" class="form-control" id="terms" placeholder="Search concepts"></div><div class="form-group col-md-1"><button type="button" class="btn btn-primary" ng-click="vm.toggleOpen()">+</button></div><div uib-collapse="!vm.isOpen" class="col-md-12"><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'maxTerms\']" popover-trigger="click" popover-placement="bottom" for="maxConcepts">Max terms</label> <input type="number" ng-model="vm.parameters.maxTerms" min="1" max="20" class="form-control" id="maxConcepts"></div><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'maxRelatedTerms\']" popover-trigger="click" popover-placement="bottom" for="maxRelatedTerms">Max related terms</label> <input type="number" ng-model="vm.parameters.maxRelatedTerms" min="1" max="20" class="form-control" id="maxRelatedTerms"></div><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'minSim\']" popover-trigger="click" popover-placement="bottom" for="minSim">Minimum concept similarity</label> <input type="number" ng-model="vm.parameters.minSim" min="0.1" max="10.0" step="0.1" class="form-control" id="minSim"></div><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'wordBoost\']" popover-trigger="click" popover-placement="bottom" for="wordBoost">Word boost</label> <input type="number" ng-model="vm.parameters.wordBoost" min="0.1" max="10.0" step="0.1" class="form-control" id="wordBoost"></div><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'boostMethod\']" popover-trigger="click" popover-placement="bottom" for="boostMethod">Boost method</label><select ng-model="vm.parameters.boostMethod" name="boostMethod" class="form-control"><option data-ng-repeat="method in vm.boostMethods" value="{{ method }}">{{ method }}</option></select></div><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'algorithm\']" popover-trigger="click" popover-placement="bottom" for="algorithm">Algorithm</label><select ng-model="vm.parameters.algorithm" name="algorithm" class="form-control"><option data-ng-repeat="algo in vm.algorithms" value="{{ algo }}">{{ algo }}</option></select></div><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'direction\']" popover-trigger="click" popover-placement="bottom" for="forward">Track direction</label><select ng-model="vm.parameters.forwards" name="forward" class="form-control"><option data-ng-repeat="dir in vm.directions" value="{{ dir }}">{{ dir }}</option></select></div><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'yearsInInterval\']" popover-trigger="click" popover-placement="bottom" for="yearsInterval">Years in interval</label> <input type="number" ng-model="vm.parameters.aggYearsInInterval" min="1" max="10" step="1" class="form-control" id="yearsInterval"></div><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'wordsPerYear\']" popover-trigger="click" popover-placement="bottom" for="wordsPerYear">Words per year</label> <input type="number" ng-model="vm.parameters.aggWordsPerYear" min="1" max="100" step="1" class="form-control" id="wordsPerYear"></div><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'weighFunc\']" popover-trigger="click" popover-placement="bottom" for="aggWeighFunc">Weighing function</label><select ng-model="vm.parameters.aggWeighFunction" name="aggWeighFunc" class="form-control"><option data-ng-repeat="wFunc in vm.weighFuncs" value="{{ wFunc }}">{{ wFunc }}</option></select></div><div class="form-group form-inline col-md-4"><label uib-popover-html="vm.tooltips[\'wFParam\']" popover-trigger="click" popover-placement="bottom" for="aggWFParam">Function shape</label> <input type="number" ng-model="vm.parameters.aggWFParam" min="1" max="10" step="0.1" class="form-control" id="aggWFParam"></div><div class="form-group form-inline col-md-4" ng-if="vm.features.canClean"><label uib-popover-html="vm.tooltips[\'doCleaning\']" popover-trigger="click" popover-placement="bottom" for="doCleaning">Do cleaning ?</label><select ng-model="vm.parameters.doCleaning" name="doCleaning" class="form-control"><option data-ng-repeat="opt in vm.doCleaning" value="{{ opt }}">{{ opt }}</option></select></div><div class="form-group col-md-11"><label uib-popover-html="vm.tooltips[\'yearPeriod\']" popover-trigger="click" popover-placement="bottom" for="doCleaning">Year period</label><rzslider rz-slider-model="vm.years.from" rz-slider-high="vm.years.to" rz-slider-options="vm.years.options"></rzslider></div></div></div>')}]);
//# sourceMappingURL=../maps/scripts/app.js.map
