!function(){"use strict";angular.module("shico",["ngResource","ngAnimate","ui.bootstrap","toastr","nvd3","rzModule","cgBusy"])}(),function(){"use strict";function r(){function r(){return t.parameters}function e(r){angular.forEach(t.parameters,function(e,a){angular.isDefined(r[a])&&(t.parameters[a]=r[a])})}function a(){var r=t.availableYears.values,e=t.availableYears.from,a=t.availableYears.to;t.parameters.startKey=r[e],t.parameters.endKey=r[a]}var t=this;t.parameters={terms:"",maxTerms:10,maxRelatedTerms:10,startKey:"",endKey:"",minDist:.1,wordBoost:1,forwards:!0,sumDistances:!1,algorithm:"adaptive",aggWeighFunction:"Gaussian",aggWFParam:1,aggYearsInInterval:1,aggWordsPerYear:5},t.availableYears={from:0,to:1,values:{},options:{floor:0,ceil:1,step:1,onChange:a}};var o={getParameters:r,setParameters:e,availableYears:t.availableYears};return o}angular.module("shico").service("TrackerParametersService",r)}(),function(){"use strict";function r(){var r={scope:{},templateUrl:"/app/components/shico/trackerParameters.template.html",controllerAs:"vm",controller:"TrackerParametersController"};return r}angular.module("shico").directive("trackerParameters",r)}(),function(){"use strict";function r(r){var e=this;e.algorithms=["adaptive","non-adaptive"],e.weighFuncs=["Gaussian","Linear","JSD"],e.years=r.availableYears,e.parameters=r.getParameters()}angular.module("shico").controller("TrackerParametersController",r),r.$inject=["TrackerParametersService"]}(),function(){"use strict";function r(){var r={scope:{},templateUrl:"/app/components/shico/trackerGraphs.template.html",controllerAs:"vm",controller:"TrackerGraphsController"};return r}angular.module("shico").directive("trackerGraphs",r)}(),function(){"use strict";function r(r){var e=this;e.streamGraph=r.streamGraph,e.forceGraph=r.forceGraph,e.slider_options=r.slider_options}angular.module("shico").controller("TrackerGraphsController",r),r.$inject=["GraphControlService"]}(),function(){"use strict"}(),function(){"use strict";function r(){var r={scope:{},templateUrl:"/app/components/shico/parameterIO.template.html",controllerAs:"vm",controller:"ParameterIOController"};return r}angular.module("shico").directive("parameterIo",r)}(),function(){"use strict";function r(r){function e(){o.hide=!1,o.readOnly=!0,o.text=JSON.stringify(r.getParameters()),o.btnText="Ok"}function a(){o.hide=!1,o.readOnly=!1,o.text="",o.btnText="Load"}function t(){if(o.hide=!0,!o.readOnly){var e=JSON.parse(o.text);r.setParameters(e)}}var o=this;o.getParameters=e,o.setParameters=a,o.closeParamIO=t,o.text="",o.readOnly=!1,o.hide=!0}angular.module("shico").controller("ParameterIOController",r),r.$inject=["TrackerParametersService"]}(),function(){"use strict";function r(r){function e(e){var n=[],i=new Set;angular.forEach(e.stream,function(r,e){n.push(e),angular.forEach(r,function(r,e){i.add(e)})});var s={};angular.forEach(n,function(r,e){s[r]=e}),r.setVocabulary(i),r.setStreamYears(n),o.yearLabels=n;var l=a(e.stream,s,i,n),c=t(e.networks,s);o.streamGraph.data=l,o.forceGraph.data=c,o.slider_options.ceil=o.yearLabels.length-1}function a(r,e,a,t){var o=[];return angular.forEach(a,function(a){var o=[];angular.forEach(t,function(t){var o=a in r[t]?r[t][a]:0;this.push([e[t],o])},o),this.push({key:a,values:o})},o),o}function t(r,e){var a={};return angular.forEach(r,function(r,t){a[e[t]]=r}),a}var o=this;o.streamGraph={options:r.getConfig("streamGraph"),data:[]},o.forceGraph={options:r.getConfig("forceGraph"),data:[],currYearIdx:0},o.yearLabels=[],o.slider_options={floor:0,ceil:0,showTicksValues:!0,translate:function(r){return o.yearLabels[r]}};var n={update:e,streamGraph:o.streamGraph,forceGraph:o.forceGraph,slider_options:o.slider_options};return n}angular.module("shico").service("GraphControlService",r),r.$inject=["GraphConfigService"]}(),function(){"use strict";function r(){function r(r){var e=0;angular.forEach(r,function(r){k[r]=e,e+=1})}function e(r){var e=r.key||r.name,a=k[e];return a?h(a):"#223344"}function a(r){return r[0]}function t(r){return r[1]}function o(r){return parseFloat(r).toFixed(1)}function n(r){return r in b?b[r]:r}function i(r){b=r}function s(r){l(r),c(r),m(r),angular.forEach(y,function(e){e(r)})}function l(r){r.append("text").attr("dx",12).attr("dy",".35em").text(function(r){return r.name}).style("font-weight",function(r){return"seed"==r.type?"bold":""})}function c(r){r.select("circle").attr("r",function(r){return 5+2*r.count})}function m(r){r.select("circle").attr("stroke",function(r){return u(r.type,"colour")}).attr("stroke-width",function(r){return u(r.type,"width")})}function u(r,e){var a="",t="";return"seed"==r?(a=2,t="red"):"word"==r?(a=0,t="black"):(a=2,t="gray"),"width"==e?a:t}function d(r){y.push(r)}function p(r){return"streamGraph"===r?v:"forceGraph"===r?g:void 0}var v={chart:{type:"stackedAreaChart",height:400,margin:{top:20,right:20,bottom:60,left:55},x:a,y:t,xAxis:{tickFormat:n},yAxis:{tickFormat:o},color:e}},f=d3.svg.symbol().type(function(r){return"seed"==r.type?"triangle-up":"circle"}).size(function(r){return 50*Math.log2(2+r.count)}),g={chart:{type:"forceDirectedGraph",height:300,width:300,color:e,symbol:f,nodeExtras:s,curveLinks:!0,useArrows:!0}},h=d3.scale.category20(),b={},y=[],k={},x={getConfig:p,setStreamYears:i,addForceGraphHook:d,setVocabulary:r};return x}angular.module("shico").service("GraphConfigService",r)}(),function(){"use strict";function r(r,e,a){function t(){var t=e.getParameters(),o=r.trackConcept(t);this.trackerPromise=o,o.then(a.update)}var o=this;o.doPost=t}angular.module("shico").controller("FormController",r),r.$inject=["ConceptService","TrackerParametersService","GraphControlService"]}(),function(){"use strict";function r(r,e){function a(){var a=r("config.json");a.get().$promise.then(function(a){var o=a.baseURL,n=o+"/track/:terms",i=o+"/available-years";0==o.length&&(n="dummy2.json",i="http://localhost:5000/available-years"),t.trackerURL=n;var s=r(i);s.get().$promise.then(function(r){e.availableYears.from=r.first,e.availableYears.to=r.last,e.availableYears.values=r.values,e.availableYears.options.floor=r.first,e.availableYears.options.ceil=r.last})})}var t={doLoad:a};return t}angular.module("shico").service("SettingsService",r),r.$inject=["$resource","TrackerParametersService"]}(),function(){"use strict";function r(r,e,a){function t(e){var t=r(a.trackerURL),n=t.get(e),i=n.$promise.then(o);return i}function o(r){return r.toJSON()}var n={trackConcept:t};return n}angular.module("shico").service("ConceptService",r),r.$inject=["$resource","$log","SettingsService"]}(),function(){"use strict";function r(r,e){r.debug("runBlock end"),e.doLoad()}angular.module("shico").run(r),r.$inject=["$log","SettingsService"]}(),function(){"use strict";angular.module("shico")}(),function(){"use strict";function r(r,e){r.debugEnabled(!0),e.allowHtml=!0,e.timeOut=3e3,e.positionClass="toast-top-right",e.preventDuplicates=!0,e.progressBar=!0}angular.module("shico").config(r),r.$inject=["$logProvider","toastrConfig"]}(),angular.module("shico").run(["$templateCache",function(r){r.put("app/components/shico/parameterIO.template.html",'<div class="row"><div class="col-md-2"><button ng-click="vm.getParameters()" class="btn btn-success">Save parameters</button></div><div class="col-md-2"><button ng-click="vm.setParameters()" class="btn btn-success">Load parameters</button></div></div><br><div class="row" ng-hide="vm.hide"><div class="col-md-8"><textarea class="form-control" rows="2" ng-readonly="vm.readOnly" ng-model="vm.text"></textarea></div><div class="col-md-2"><button ng-click="vm.closeParamIO()" class="btn btn-success">{{ vm.btnText }}</button></div></div>'),r.put("app/components/shico/trackerGraphs.template.html",'<div class="row"><div class="col-md-12"><nvd3 data="vm.streamGraph.data" options="vm.streamGraph.options"></nvd3></div></div><div class="row"><div class="col-md-8 col-md-offset-2"><center><nvd3 data="vm.forceGraph.data[vm.forceGraph.currYearIdx]" options="vm.forceGraph.options"></nvd3></center><rzslider ng-hide="!vm.slider_options.ceil" rz-slider-model="vm.forceGraph.currYearIdx" rz-slider-options="vm.slider_options"></rzslider></div></div>'),r.put("app/components/shico/trackerParameters.template.html",'<div class="row form-horizontal col-md-12"><p class="lead">Concept search</p><div class="form-group col-md-11"><input type="text" ng-model="vm.parameters.terms" class="form-control" id="terms" placeholder="Search concepts"></div><div class="form-group col-md-1"><button type="button" class="btn btn-primary" ng-click="isOpen = !isOpen">+</button></div><div uib-collapse="!isOpen"><div><div class="form-group form-inline col-md-4"><label for="maxConcepts">Max terms</label> <input type="number" ng-model="vm.parameters.maxTerms" min="1" max="20" class="form-control" id="maxConcepts"></div><div class="form-group form-inline col-md-4"><label for="maxRelatedTerms">Max related terms</label> <input type="number" ng-model="vm.parameters.maxRelatedTerms" min="1" max="20" class="form-control" id="maxRelatedTerms"></div><div class="form-group form-inline col-md-4"><label for="minDist">Minimum concept distance</label> <input type="number" ng-model="vm.parameters.minDist" min="0.1" max="10.0" step="0.1" class="form-control" id="minDist"></div><div class="form-group form-inline col-md-4"><label for="wordBoost">Word boost</label> <input type="number" ng-model="vm.parameters.wordBoost" min="0.1" max="10.0" step="0.1" class="form-control" id="wordBoost"></div><div class="form-group form-inline col-md-4"><label for="sumDistances">Sum distances</label> <input type="checkbox" ng-model="vm.parameters.sumDistances" class="form-control" id="sumDistances"></div><div class="form-group form-inline col-md-4"><label for="algorithm">Algorithm:</label><select ng-model="vm.parameters.algorithm" name="algorithm"><option data-ng-repeat="algo in vm.algorithms" value="{{ algo }}">{{ algo }}</option></select></div><div class="form-group col-md-12"><label for="forward">Track direction</label><div class="radio"><label><input type="radio" ng-model="vm.parameters.forwards" ng-value="true" id="forward"> Forwards</label></div><div class="radio"><label><input type="radio" ng-model="vm.parameters.forwards" ng-value="false" id="forward"> Backwards</label></div></div><div class="form-group form-inline col-md-4"><label for="yearsInterval">Years in interval</label> <input type="number" ng-model="vm.parameters.aggYearsInInterval" min="1" max="10" step="1" class="form-control" id="yearsInterval"></div><div class="form-group form-inline col-md-4"><label for="wordsPerYear">Words per year</label> <input type="number" ng-model="vm.parameters.aggWordsPerYear" min="1" max="100" step="1" class="form-control" id="wordsPerYear"></div><div class="form-group form-inline col-md-4"><label for="aggWeighFunc">Weighing function</label><select ng-model="vm.parameters.aggWeighFunction" name="aggWeighFunc"><option data-ng-repeat="wFunc in vm.weighFuncs" value="{{ wFunc }}">{{ wFunc }}</option></select></div><div class="form-group form-inline col-md-4"><label for="aggWFParam">Weighing function parameter</label> <input type="number" ng-model="vm.parameters.aggWFParam" min="1" max="10" step="0.1" class="form-control" id="aggWFParam"></div></div><div class="form-group col-md-11">Year period:<rzslider rz-slider-model="vm.years.from" rz-slider-high="vm.years.to" rz-slider-options="vm.years.options"></rzslider></div></div></div>')}]);
//# sourceMappingURL=../maps/scripts/app-3064c7a891.js.map
